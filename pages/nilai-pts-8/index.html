<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
<title>REKAP NILAI PTS — Semester Ganjil 2025/2026</title>
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
<style>
:root{--primary:#001F3F;--accent-gold:#D4AF37;--bg-light:#F5F5DC;--bg-white:#F5F5F5;--text-dark:#0F172A;--success:#16A34A;--warning:#D97706;--danger:#B91C1C;--info:#3B82F6;--border:#E5E7EB;--shadow:rgba(0,31,63,.1);--font-serif:'Georgia',serif;--font-sans:'Arial',sans-serif}body.dark{--primary:#1A202C;--accent-gold:#B7791F;--bg-light:#1A202C;--bg-white:#2D3748;--text-dark:#E2E8F0;--success:#48BB78;--warning:#ED8936;--danger:#F56565;--info:#4299E1;--border:#4A5568;--shadow:rgba(0,0,0,.3)}*{box-sizing:border-box;margin:0;padding:0}body{background:linear-gradient(180deg,var(--bg-light),var(--bg-white));color:var(--text-dark);font-family:var(--font-sans);line-height:1.6;min-height:100vh;padding:1rem;transition:background .3s ease,color .3s ease;will-change:background,color}.container{max-width:1100px;margin:0 auto;padding:1rem}.back-nav{margin-bottom:1rem}.back-btn{display:inline-flex;align-items:center;gap:.5rem;color:#fff;text-decoration:none;font-weight:600;font-size:.85rem;padding:.5rem .8rem;border-radius:.5rem;background:var(--primary);border:1.5px solid var(--accent-gold);box-shadow:0 3px 8px rgba(0,0,0,.2);transition:all .2s ease;min-height:44px;min-width:44px;touch-action:manipulation}.back-btn i{color:var(--accent-gold)}.back-btn:hover{background:var(--accent-gold);color:var(--primary);transform:translateY(-1px);box-shadow:0 5px 12px rgba(212,175,55,.3)}.back-btn:hover i{color:var(--primary)}.hero{background:var(--primary);color:#FFF;padding:1.5rem;border-radius:1rem;box-shadow:0 4px 12px var(--shadow);text-align:center;position:relative;overflow:hidden;transition:background .3s ease,color .3s ease;will-change:background}.hero h1{font-family:var(--font-serif);font-size:1.8rem;font-weight:700;color:var(--accent-gold);margin-bottom:.5rem}.hero .sub{font-size:1rem;opacity:.95;font-style:italic}.hero .meta{display:flex;justify-content:center;gap:1rem;flex-wrap:wrap;margin-top:.5rem;font-size:.9rem;color:var(--accent-gold);font-weight:600}.hero .meta b{color:#FFF}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem;margin:2rem 0}.stat-card{background:#FFF;border-radius:.75rem;padding:1rem;text-align:center;box-shadow:0 2px 8px var(--shadow);border:1px solid var(--border);transition:background .3s ease,border .3s ease;will-change:background,border}body.dark .stat-card{background:var(--bg-white);border:1px solid var(--border)}.stat-icon{font-size:1.5rem;color:var(--accent-gold);margin-bottom:.5rem}.stat-number{font-size:1.5rem;font-weight:600;color:var(--primary)}.stat-label{font-size:.875rem;color:var(--text-dark);opacity:.8;font-weight:600}body.dark .stat-card .stat-label{color:#E2E8F0 !important}body.dark .stat-card .stat-number{color:#F7FAFC !important;font-weight:700}.controls-card{background:#FFF;border-radius:1rem;padding:1rem;box-shadow:0 4px 12px var(--shadow);border:1px solid var(--border);margin-bottom:1rem;transition:background .3s ease,border .3s ease;will-change:background,border}body.dark .controls-card{background:var(--bg-white);border:1px solid var(--border)}.controls{display:flex;gap:.75rem;flex-wrap:wrap;align-items:center}@media (max-width:768px){.controls{flex-direction:column;gap:1rem}}input[type=search],select,.chk{background:#FFF;color:var(--text-dark);border:1px solid var(--border);border-radius:.75rem;padding:.6rem .9rem;outline:none;font-size:.875rem;transition:background .3s ease,color .3s ease,border .3s ease;will-change:background,color,border;min-height:44px;touch-action:manipulation}body.dark input[type=search],body.dark select{background:var(--bg-white);color:var(--text-dark);border:1px solid var(--border)}input[type=search]{flex:1;min-width:220px}@media (max-width:768px){input[type=search]{min-width:100%}}select{min-width:210px}@media (max-width:768px){select{min-width:100%}}.chk{display:flex;align-items:center;gap:.5rem;font-size:.875rem;cursor:pointer;color:var(--text-dark);min-height:44px}body.dark .chk{color:#1A202C;font-weight:600}.chk input{margin:0}.table-container{background:#FFF;border-radius:1rem;overflow:hidden;box-shadow:0 4px 12px var(--shadow);border:1px solid var(--border);transition:background .3s ease,border .3s ease;will-change:background,border;overflow-x:auto}body.dark .table-container{background:var(--bg-white);border:1px solid var(--border)}table{width:100%;border-collapse:collapse;text-align:center;min-width:800px}thead{background:var(--primary);color:#FFF;transition:background .3s ease;will-change:background}th{padding:.9rem .75rem;font-weight:600;font-size:.875rem;position:sticky;top:0;z-index:10}td{padding:.75rem;border-top:1px solid var(--border);font-size:.875rem;transition:border .3s ease;will-change:border}tbody tr:hover{background:rgba(212,175,55,.05);transition:background .2s ease}body.dark tbody tr:hover{background:rgba(183,121,31,.1)}.num{width:56px}.right{text-align:right;white-space:nowrap}.chip{display:inline-block;padding:.25rem .75rem;border-radius:.5rem;font-weight:700;font-size:.75rem;min-width:3rem;transition:background .3s ease,color .3s ease;will-change:background,color}.ok{background:var(--success);color:#FFF}.warn{background:var(--warning);color:#FFF}.bad{background:var(--danger);color:#FFF}.info{background:var(--info);color:#FFF}.footer{text-align:center;margin-top:2rem;padding:1rem;font-size:.875rem;color:var(--text-dark);border-top:1px solid var(--border);transition:color .3s ease,border .3s ease;will-change:color,border}.footer a{color:var(--accent-gold);text-decoration:none;transition:color .3s ease}.footer a:hover{text-decoration:underline}.dark-toggle{position:fixed;top:1rem;right:1rem;z-index:1000;background:var(--primary);color:#FFF;border:none;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 2px 6px var(--shadow);transition:all .2s ease;min-height:44px;min-width:44px;touch-action:manipulation}.dark-toggle:hover{background:var(--accent-gold);color:var(--primary)}body.dark .dark-toggle{background:var(--accent-gold);color:var(--primary)}body.dark .dark-toggle:hover{background:var(--primary);color:var(--accent-gold)}.whatsapp-float{position:fixed;bottom:2rem;right:2rem;z-index:1000;background:linear-gradient(135deg,#25D366,#128C7E);color:#FFF;border-radius:16px;width:56px;height:56px;box-shadow:0 4px 15px rgba(37,211,102,.4);transition:all .3s ease;display:flex;align-items:center;justify-content:center;text-decoration:none;touch-action:manipulation}.whatsapp-float:hover{transform:translateY(-4px) scale(1.05);box-shadow:0 8px 20px rgba(37,211,102,.5)}.whatsapp-float i{font-size:1.9rem;filter:drop-shadow(0 1px 2px rgba(0,0,0,.2))}#back-to-top{position:fixed;bottom:7rem;right:2rem;z-index:1000;background:var(--primary);color:#FFF;border:none;border-radius:50%;width:40px;height:40px;display:none;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 2px 6px var(--shadow);transition:all .2s ease;min-height:44px;min-width:44px;touch-action:manipulation}#back-to-top:hover{background:var(--accent-gold);color:var(--primary)}#back-to-top.show{display:flex}@media (max-width:768px){.hero h1{font-size:1.5rem}.hero .sub,.hero .meta{font-size:.85rem}.stats-grid{grid-template-columns:1fr 1fr;gap:.75rem;margin:1.5rem 0}.stat-card{padding:.75rem}.stat-icon{font-size:1.3rem}.stat-number{font-size:1.3rem}.stat-label{font-size:.8rem}.controls-card{padding:.75rem}.controls{gap:.5rem}.table-container{overflow-x:auto}th,td{padding:.5rem .6rem;font-size:.8rem}.footer{padding:.75rem;font-size:.8rem}.whatsapp-float{bottom:1rem;right:1rem;width:50px;height:50px}#back-to-top{bottom:5.5rem;right:1rem;width:35px;height:35px}.dark-toggle{top:.5rem;right:.5rem}} @media (max-width:480px){.stats-grid{grid-template-columns:1fr;gap:1rem}.stat-card{padding:.6rem}.stat-icon{font-size:1.2rem}.stat-number{font-size:1.2rem}.stat-label{font-size:.75rem}.container{padding:.5rem}}
</style>
</head>
<body>
<button class="dark-toggle" onclick="toggleDarkMode()"><i class="fas fa-moon"></i></button>
<div class="container">
<div class="back-nav"><a href="../index.html" class="back-btn"><i class="fas fa-arrow-left"></i><span>Back to Dashboard</span></a></div>
<section class="hero"><h1>REKAP NILAI PTS — Semester Ganjil 2025/2026</h1><div class="sub">MTsT Daarut Tahfizh Al-Ikhlas (DTI)</div><div class="meta"><div>Guru: <b>Ahmad Zaman Huri, S.Pd.</b></div><div>Kelas: VIII</div><div id="ts">Diperbarui: —</div></div></section>
<section class="stats-grid"><div class="stat-card"><i class="fas fa-users stat-icon"></i><div class="stat-number" id="kpiTotal">0</div><div class="stat-label">Total Siswa</div></div><div class="stat-card"><i class="fas fa-exclamation-triangle stat-icon"></i><div class="stat-number" id="kpiRem">0</div><div class="stat-label">Siswa Remedial</div></div><div class="stat-card"><i class="fas fa-trophy stat-icon"></i><div class="stat-number" id="kpiHigh">-</div><div class="stat-label">Nilai Tertinggi</div></div><div class="stat-card"><i class="fas fa-arrow-trend-down stat-icon"></i><div class="stat-number" id="kpiLow">-</div><div class="stat-label">Nilai Terendah</div></div></section>
<section class="controls-card"><div class="controls"><input id="q" type="search" placeholder="Cari Nama Siswa…"><select id="sortSelect" title="Urutkan"><option value="name_asc">Urut Nama A → Z</option><option value="name_desc">Urut Nama Z → A</option><option value="score_desc">Nilai Akhir Tertinggi → Terendah</option><option value="score_asc">Nilai Akhir Terendah → Tertinggi</option></select><label class="chk"><input type="checkbox" id="remOnly"> Tampilkan Remedial saja</label></div></section>
<div class="table-container"><table id="tbl"><thead><tr id="thead"></tr></thead><tbody id="tbody"><tr><td colspan="9" style="padding:2rem;color:var(--text-dark);"><i class="fas fa-spinner fa-spin"></i> Memuat data…</td></tr></tbody></table></div>
<footer class="footer"><div><i class="fas fa-book-open"></i> <b>REKAP NILAI PTS</b> · Developed by <a href="https://wa.me/6282246077307" target="_blank"><b>Ahmad Zaman Huri, S.Pd.</b></a></div></footer>
</div>
<a href="https://wa.me/6282246077307" class="whatsapp-float" target="_blank" title="Hubungi via WhatsApp"><i class="fab fa-whatsapp"></i></a>
<button id="back-to-top" onclick="scrollToTop()"><i class="fas fa-arrow-up"></i></button>
<script>
function toggleDarkMode(){document.body.classList.toggle('dark');const icon=document.querySelector('.dark-toggle i');icon.classList.toggle('fa-moon');icon.classList.toggle('fa-sun')}function scrollToTop(){window.scrollTo({top:0,behavior:'smooth'})}window.addEventListener('scroll',()=>{const btn=document.getElementById('back-to-top');if(window.scrollY>100){btn.classList.add('show')}else{btn.classList.remove('show')}});(async()=>{const CSV_URL="https://docs.google.com/spreadsheets/d/1yT7_KQLVylZEPqHKucrt1Zz7d2gHEiOx4pgmGKPALa0/gviz/tq?tqx=out:csv&sheet=VIII_Scores";const wantCols=["No","Name","Class","Attendance","Part A","Part B","Part C","Nilai Akhir","Status"];try{const toRows=(csv)=>csv.trim().split(/\r?\n/).map(line=>line.match(/("([^"]|"")*"|[^,])+/g)?.map(s=>{s=s.trim();if(s.startsWith('"')&&s.endsWith('"'))s=s.slice(1,-1).replace(/""/g,'"');return s})??[]);const res=await fetch(CSV_URL);if(!res.ok)throw new Error('Gagal mengambil data');const text=await res.text();const rows=toRows(text);const head=rows.shift()||[];const pos=wantCols.map(c=>head.indexOf(c));const raw=rows.map(r=>pos.map(i=>i>=0?r[i]??"":""));const thead=document.getElementById("thead");wantCols.forEach(c=>{const th=document.createElement("th");th.textContent=c;thead.appendChild(th)});const tbody=document.getElementById("tbody");const kpiTotal=document.getElementById("kpiTotal"),kpiRem=document.getElementById("kpiRem"),kpiHigh=document.getElementById("kpiHigh"),kpiLow=document.getElementById("kpiLow");document.getElementById("ts").textContent="Diperbarui: "+new Date().toLocaleString();const badge=(val,type)=>{const span=document.createElement("span");let cls="info";if(type==="status"){if(/tidak\s*hadir|absen|alpa/i.test(val))cls="bad";else if(/remed/i.test(val))cls="warn";else if(/lulus/i.test(val))cls="ok";else if(/susulan/i.test(val))cls="info"}else if(type==="att"){cls=/tidak\s*hadir|absen|alpa/i.test(val)?"bad":/hadir/i.test(val)?"ok":/susulan/i.test(val)?"info":"info"}span.className="chip "+cls;span.textContent=val||"-";return span};const allScores=raw.map(r=>parseFloat(r[7])).filter(n=>!isNaN(n));const remedCount=raw.reduce((a,r)=>a+(/remed/i.test(r[8])?1:0),0);kpiTotal.textContent=raw.length;kpiRem.textContent=remedCount;kpiHigh.textContent=allScores.length?Math.max(...allScores):"-";kpiLow.textContent=allScores.length?Math.min(...allScores):"-";const state={q:"",remOnly:false,sort:"name_asc"};const cmp={name_asc:(a,b)=>a[1].localeCompare(b[1]),name_desc:(a,b)=>b[1].localeCompare(a[1]),score_desc:(a,b)=>(parseFloat(b[7])||-1)-(parseFloat(a[7])||-1),score_asc:(a,b)=>(parseFloat(a[7])||1e9)-(parseFloat(b[7])||1e9)};const render=()=>{const q=state.q.toLowerCase().trim();const filtered=raw.filter(r=>{const line=r.join(" ").toLowerCase();if(q&&!line.includes(q))return false;if(state.remOnly&&!/remed/i.test(r[8]))return false;return true}).sort(cmp[state.sort]);tbody.innerHTML="";if(!filtered.length){tbody.innerHTML='<tr><td colspan="9" style="color:var(--text-dark);padding:1.5rem;">Tidak ada data sesuai filter/pencarian.</td></tr>';return}filtered.forEach(r=>{const tr=document.createElement("tr");r.forEach((v,i)=>{const td=document.createElement("td");if(i===0)td.className="num";if(i===3)td.appendChild(badge(v,"att"));else if(i===8)td.appendChild(badge(v,"status"));else if(/Part A|Part B|Part C|Nilai Akhir/.test(wantCols[i])){td.className="right";td.textContent=v}else td.textContent=v||"-";tr.appendChild(td)});tbody.appendChild(tr)})};render();document.getElementById("q").oninput=e=>{state.q=e.target.value;render()};document.getElementById("sortSelect").onchange=e=>{state.sort=e.target.value;render()};document.getElementById("remOnly").onchange=e=>{state.remOnly=e.target.checked;render()}}catch(error){document.getElementById("tbody").innerHTML='<tr><td colspan="9" style="color:var(--danger);padding:2rem;text-align:center;"><i class="fas fa-exclamation-circle"></i> Gagal memuat data</td></tr>'}})()
</script>
</body>
</html>