<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
<title>Rekap Hasil Penilaian Tengah Semester - MTsT Daarut Tahfizh Al-Ikhlas</title>
<meta name="description" content="Rekap Nilai PTS Kelas 8–9 - Bahasa Inggris">
<meta name="author" content="Ahmad Zaman Huri, S.Pd.">
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
<style>
:root{--primary:#001F3F;--accent-gold:#D4AF37;--bg-light:#F5F5DC;--bg-white:#F5F5F5;--text-dark:#0F172A;--success:#16A34A;--warning:#D97706;--danger:#B91C1C;--info:#3B82F6;--border:#E5E7EB;--shadow:rgba(0,31,63,.1);--font-serif:'Georgia',serif;--font-sans:'Arial',sans-serif}body.dark{--primary:#1A202C;--accent-gold:#B7791F;--bg-light:#1A202C;--bg-white:#2D3748;--text-dark:#E2E8F0;--success:#48BB78;--warning:#ED8936;--danger:#F56565;--info:#4299E1;--border:#4A5568;--shadow:rgba(0,0,0,.3)}*{box-sizing:border-box;margin:0;padding:0}body{background:linear-gradient(180deg,var(--bg-light),var(--bg-white));color:var(--text-dark);font-family:var(--font-sans);line-height:1.6;min-height:100vh;padding:1rem;transition:background .3s ease,color .3s ease;will-change:background,color}.container{max-width:1000px;margin:0 auto;padding:1rem}.back-nav{margin-bottom:1rem}.back-btn{display:inline-flex;align-items:center;gap:.5rem;color:#fff;text-decoration:none;font-weight:600;font-size:.85rem;padding:.5rem .8rem;border-radius:.5rem;background:var(--primary);border:1.5px solid var(--accent-gold);box-shadow:0 3px 8px rgba(0,0,0,.2);transition:all .2s ease;min-height:44px;min-width:44px;touch-action:manipulation}.back-btn i{color:var(--accent-gold)}.back-btn:hover{background:var(--accent-gold);color:var(--primary);transform:translateY(-1px);box-shadow:0 5px 12px rgba(212,175,55,.3)}.back-btn:hover i{color:var(--primary)}.hero{background:var(--primary);color:#FFF;padding:1.5rem;border-radius:1rem;box-shadow:0 4px 12px var(--shadow);text-align:center;position:relative;overflow:hidden;transition:background .3s ease,color .3s ease;will-change:background}.hero h1{font-family:var(--font-serif);font-size:1.8rem;font-weight:700;color:var(--accent-gold);margin-bottom:.5rem}.hero .sub{font-size:1rem;opacity:.95;font-style:italic}.hero .meta{display:flex;justify-content:center;gap:1rem;flex-wrap:wrap;margin-top:.5rem;font-size:.9rem;color:var(--accent-gold);font-weight:600}.hero .meta b{color:var(--accent-gold)}body.dark .hero .meta,body.dark .hero .meta b{color:#B7791F}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem;margin:2rem 0}.stat-card{background:#FFF;border-radius:.75rem;padding:1rem;text-align:center;box-shadow:0 2px 8px var(--shadow);border:1px solid var(--border);transition:background .3s ease,border .3s ease;will-change:background,border}body.dark .stat-card{background:var(--bg-white);border:1px solid var(--border)}.stat-icon{font-size:1.5rem;color:var(--accent-gold);margin-bottom:.5rem}.stat-number{font-size:1.5rem;font-weight:600;color:var(--primary)}.stat-label{font-size:.875rem;color:var(--text-dark);opacity:.8;font-weight:600}body.dark .stat-card .stat-label{color:#E2E8F0 !important}body.dark .stat-card .stat-number{color:#F7FAFC !important;font-weight:700}.table-container{background:#FFF;border-radius:1rem;overflow:hidden;box-shadow:0 4px 12px var(--shadow);border:1px solid var(--border);transition:background .3s ease,border .3s ease;will-change:background,border;overflow-x:auto}body.dark .table-container{background:var(--bg-white);border:1px solid var(--border)}table{width:100%;border-collapse:collapse;text-align:center;min-width:800px}thead{background:var(--primary);color:#FFF;transition:background .3s ease;will-change:background}th{padding:.9rem .75rem;font-weight:600;font-size:.875rem;position:sticky;top:0;z-index:10}td{padding:.75rem;border-top:1px solid var(--border);font-size:.875rem;transition:border .3s ease;will-change:border}tbody tr:hover{background:rgba(212,175,55,.05);transition:background .2s ease}body.dark tbody tr:hover{background:rgba(183,121,31,.1)}tr:last-child td{font-weight:600;background:rgba(212,175,55,.05)}body.dark tr:last-child td{background:rgba(183,121,31,.1)}.class-badge{background:var(--accent-gold);color:var(--primary);padding:.25rem .75rem;border-radius:.5rem;font-weight:600}.grade-badge,.status-badge{padding:.25rem .75rem;border-radius:.5rem;font-weight:700;display:inline-block;min-width:3rem;color:#FFF;transition:background .3s ease,color .3s ease;will-change:background,color}.grade-red,.status-red{background:var(--danger)}.grade-orange,.status-orange{background:var(--warning)}.grade-blue,.status-blue{background:var(--info)}.grade-green,.status-green{background:var(--success)}.loading{text-align:center;padding:2rem;color:var(--text-dark)}.footer{text-align:center;margin-top:2rem;padding:1rem;font-size:.875rem;color:var(--text-dark);border-top:1px solid var(--border);transition:color .3s ease,border .3s ease;will-change:color,border}.footer a{color:var(--accent-gold);text-decoration:none;transition:color .3s ease}.footer a:hover{text-decoration:underline}.dark-toggle{position:fixed;top:1rem;right:1rem;z-index:1000;background:var(--primary);color:#FFF;border:none;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 2px 6px var(--shadow);transition:all .2s ease;min-height:44px;min-width:44px;touch-action:manipulation}.dark-toggle:hover{background:var(--accent-gold);color:var(--primary)}body.dark .dark-toggle{background:var(--accent-gold);color:var(--primary)}body.dark .dark-toggle:hover{background:var(--primary);color:var(--accent-gold)}.whatsapp-float{position:fixed;bottom:2rem;right:2rem;z-index:1000;background:linear-gradient(135deg,#25D366,#128C7E);color:#FFF;border-radius:16px;width:56px;height:56px;box-shadow:0 4px 15px rgba(37,211,102,.4);transition:all .3s ease;display:flex;align-items:center;justify-content:center;text-decoration:none;touch-action:manipulation}.whatsapp-float:hover{transform:translateY(-4px) scale(1.05);box-shadow:0 8px 20px rgba(37,211,102,.5)}.whatsapp-float i{font-size:1.9rem;filter:drop-shadow(0 1px 2px rgba(0,0,0,.2))}#back-to-top{position:fixed;bottom:7rem;right:2rem;z-index:1000;background:var(--primary);color:#FFF;border:none;border-radius:50%;width:40px;height:40px;display:none;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 2px 6px var(--shadow);transition:all .2s ease;min-height:44px;min-width:44px;touch-action:manipulation}#back-to-top:hover{background:var(--accent-gold);color:var(--primary)}#back-to-top.show{display:flex}@media (max-width:768px){.hero h1{font-size:1.5rem}.hero .sub,.hero .meta{font-size:.85rem}.stats-grid{grid-template-columns:1fr 1fr;gap:.75rem;margin:1.5rem 0}.stat-card{padding:.75rem}.stat-icon{font-size:1.3rem}.stat-number{font-size:1.3rem}.stat-label{font-size:.8rem}.table-container{overflow-x:auto}th,td{padding:.5rem .6rem;font-size:.8rem}.footer{padding:.75rem;font-size:.8rem}.whatsapp-float{bottom:1rem;right:1rem;width:50px;height:50px}#back-to-top{bottom:5.5rem;right:1rem;width:35px;height:35px}.dark-toggle{top:.5rem;right:.5rem}} @media (max-width:480px){.stats-grid{grid-template-columns:1fr;gap:1rem}.stat-card{padding:.6rem}.stat-icon{font-size:1.2rem}.stat-number{font-size:1.2rem}.stat-label{font-size:.75rem}.container{padding:.5rem}}
</style>
</head>
<body>
<button class="dark-toggle" onclick="toggleDarkMode()"><i class="fas fa-moon"></i></button>
<div class="container">
<div class="back-nav"><a href="../index.html" class="back-btn"><i class="fas fa-arrow-left"></i><span>Back to Dashboard</span></a></div>
<section class="hero"><h1>REKAP HASIL PENILAIAN TENGAH SEMESTER</h1><div class="sub">Semester Ganjil 2025 / Kelas 8–9 MTsT Daarut Tahfizh Al-Ikhlas</div><div class="meta"><div>Guru: <b>Ahmad Zaman Huri, S.Pd.</b></div></div></section>
<section class="stats-grid"><div class="stat-card"><i class="fas fa-users stat-icon"></i><div class="stat-number" id="totalStudents">-</div><div class="stat-label">Total Siswa</div></div><div class="stat-card"><i class="fas fa-check-circle stat-icon"></i><div class="stat-number" id="totalPassed">-</div><div class="stat-label">Lulus</div></div><div class="stat-card"><i class="fas fa-exclamation-triangle stat-icon"></i><div class="stat-number" id="totalRemedial">-</div><div class="stat-label">Remedial</div></div><div class="stat-card"><i class="fas fa-chart-line stat-icon"></i><div class="stat-number" id="averageScore">-</div><div class="stat-label">Rata-Rata Total</div></div></section>
<div class="table-container"><table id="rekapTable"><thead><tr><th>Class</th><th>Jumlah Siswa</th><th>Lulus</th><th>Remedial</th><th>Susulan</th><th>Tidak Hadir</th><th>Rata-Rata</th><th>Keterangan</th></tr></thead><tbody id="tableBody"><tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i> Memuat data...</td></tr></tbody></table></div>
<footer class="footer"><div><i class="fas fa-book-open"></i> <b>REKAP HASIL PTS</b> · Developed by <a href="https://wa.me/6282246077307" target="_blank">Ahmad Zaman Huri, S.Pd.</a></div></footer>
</div>
<a href="https://wa.me/6282246077307" class="whatsapp-float" target="_blank" title="Hubungi via WhatsApp"><i class="fab fa-whatsapp"></i></a>
<button id="back-to-top" onclick="scrollToTop()"><i class="fas fa-arrow-up"></i></button>
<script>
function toggleDarkMode(){document.body.classList.toggle('dark');const icon=document.querySelector('.dark-toggle i');icon.classList.toggle('fa-moon');icon.classList.toggle('fa-sun')}function scrollToTop(){window.scrollTo({top:0,behavior:'smooth'})}window.addEventListener('scroll',()=>{const btn=document.getElementById('back-to-top');if(window.scrollY>100){btn.classList.add('show')}else{btn.classList.remove('show')}});(async()=>{const SHEET_URL="https://docs.google.com/spreadsheets/d/1yT7_KQLVylZEPqHKucrt1Zz7d2gHEiOx4pgmGKPALa0/gviz/tq?tqx=out:csv&sheet=Rekap_Kelas";const tableBody=document.getElementById("tableBody");const totalStudents=document.getElementById("totalStudents"),totalPassed=document.getElementById("totalPassed"),totalRemedial=document.getElementById("totalRemedial"),averageScore=document.getElementById("averageScore");const parseCSV=csv=>{const rows=[];let row=[],val="",inQuotes=false;for(let i=0;i<csv.length;i++){const char=csv[i],nextChar=csv[i+1];if(char==='"'){inQuotes=!inQuotes}else if(char===','&&!inQuotes){row.push(val.trim());val=""}else if(char==='\n'&&!inQuotes){row.push(val.trim());rows.push(row);row=[];val=""}else if(char==='\r'&&nextChar==='\n'&&!inQuotes){row.push(val.trim());rows.push(row);row=[];val="";i++}else{val+=char}}if(val.trim()||row.length){row.push(val.trim());rows.push(row)}return rows};const normalize=t=>(t||"").replace(/\ufeff/g,"").trim().toLowerCase();const gradeClass=s=>{const n=parseFloat(s);if(isNaN(n))return"";if(n<65)return"grade-red";if(n<=74)return"grade-orange";if(n<=85)return"grade-blue";return"grade-green"};const statusClass=k=>{const ket=normalize(k);if(ket.includes("sangat baik"))return"status-green";if(ket.includes("perlu perbaikan"))return"status-orange";if(ket.includes("baik"))return"status-blue";if(ket.includes("kurang"))return"status-red";return""};const renderTable=data=>{tableBody.innerHTML="";if(!data.length){tableBody.innerHTML='<tr><td colspan="8" style="color:var(--text-dark);padding:1.5rem;">Tidak ada data</td></tr>';return}data.forEach(item=>{const rate=item.rataRata?.trim()||"-",ket=item.keterangan?.trim()||"-";const rateBadge=rate==="-"?"-":`<span class="grade-badge ${gradeClass(rate)}">${rate}</span>`;const ketBadge=ket==="-"?"-":`<span class="status-badge ${statusClass(ket)}">${ket}</span>`;const tr=document.createElement("tr");tr.innerHTML=`<td><span class="class-badge">${item.class||"-"}</span></td><td>${item.jumlah}</td><td>${item.lulus}</td><td>${item.remedial}</td><td>${item.susulan}</td><td>${item.tidakHadir}</td><td>${rateBadge}</td><td>${ketBadge}</td>`;tableBody.appendChild(tr)})};const updateStatistics=data=>{const total=data.find(d=>normalize(d.class)==="total")||{};totalStudents.textContent=total.jumlah?.trim()||'0';totalPassed.textContent=total.lulus?.trim()||'0';totalRemedial.textContent=total.remedial?.trim()||'0';averageScore.textContent=total.rataRata?.trim()||'0'};try{tableBody.innerHTML='<tr><td colspan="8" class="loading"><i class="fas fa-spinner fa-spin"></i> Memuat data...</td></tr>';const res=await fetch(SHEET_URL);if(!res.ok)throw new Error(`HTTP ${res.status}`);const csv=await res.text();if(!csv.trim())throw new Error("Data kosong");const rows=parseCSV(csv);if(rows.length<2)throw new Error("Data tidak lengkap");const header=rows[0].map(normalize);const getIndex=n=>header.indexOf(normalize(n));const indices={class:getIndex("class")>=0?getIndex("class"):0,jumlah:getIndex("jumlah siswa"),lulus:getIndex("lulus"),remedial:getIndex("remedial"),susulan:getIndex("susulan"),tidakHadir:getIndex("tidak hadir"),rataRata:getIndex("rata-rata"),keterangan:getIndex("keterangan")};const data=rows.slice(1).map(row=>({class:row[indices.class]?.trim()||"-",jumlah:row[indices.jumlah]?.trim()||"0",lulus:row[indices.lulus]?.trim()||"0",remedial:row[indices.remedial]?.trim()||"0",susulan:row[indices.susulan]?.trim()||"0",tidakHadir:row[indices.tidakHadir]?.trim()||"0",rataRata:row[indices.rataRata]?.trim()||"-",keterangan:row[indices.keterangan]?.trim()||"-"}));renderTable(data);updateStatistics(data)}catch(error){tableBody.innerHTML=`<tr><td colspan="8" style="color:var(--danger);padding:2rem;text-align:center;"><i class="fas fa-exclamation-circle"></i> Gagal memuat data: ${error.message}</td></tr>`}})()
</script>
</body>
</html>