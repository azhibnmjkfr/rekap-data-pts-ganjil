<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
<title>Rubrik Penilaian PTS - MTsT Daarut Tahfizh Al-Ikhlas</title>
<meta name="description" content="Rubrik Penilaian PTS - MTsT Daarut Tahfizh Al-Ikhlas">
<meta name="author" content="Ahmad Zaman Huri, S.Pd.">
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
<style>
:root{--primary:#001F3F;--accent-gold:#D4AF37;--bg-light:#F5F5DC;--bg-white:#F5F5F5;--text-dark:#0F172A;--success:#16A34A;--warning:#D97706;--danger:#B91C1C;--info:#3B82F6;--border:#E5E7EB;--shadow:rgba(0,31,63,.1);--font-serif:'Georgia',serif;--font-sans:'Arial',sans-serif}body.dark{--primary:#1A202C;--accent-gold:#B7791F;--bg-light:#1A202C;--bg-white:#2D3748;--text-dark:#E2E8F0;--success:#48BB78;--warning:#ED8936;--danger:#F56565;--info:#4299E1;--border:#4A5568;--shadow:rgba(0,0,0,.3)}*{box-sizing:border-box;margin:0;padding:0}body{background:linear-gradient(180deg,var(--bg-light),var(--bg-white));color:var(--text-dark);font-family:var(--font-sans);line-height:1.6;min-height:100vh;padding:1rem;transition:background .3s ease,color .3s ease;will-change:background,color}.container{max-width:1100px;margin:0 auto;padding:1rem}.back-nav{margin-bottom:1rem}.back-btn{display:inline-flex;align-items:center;gap:.5rem;color:#fff;text-decoration:none;font-weight:600;font-size:.85rem;padding:.5rem .8rem;border-radius:.5rem;background:var(--primary);border:1.5px solid var(--accent-gold);box-shadow:0 3px 8px rgba(0,0,0,.2);transition:all .2s ease;min-height:44px;min-width:44px;touch-action:manipulation}.back-btn i{color:var(--accent-gold)}.back-btn:hover{background:var(--accent-gold);color:var(--primary);transform:translateY(-1px);box-shadow:0 5px 12px rgba(212,175,55,.3)}.back-btn:hover i{color:var(--primary)}.hero{background:var(--primary);color:#FFF;padding:1.5rem;border-radius:1rem;box-shadow:0 4px 12px var(--shadow);text-align:center;position:relative;overflow:hidden;transition:background .3s ease,color .3s ease;will-change:background}.hero h1{font-family:var(--font-serif);font-size:1.8rem;font-weight:700;color:var(--accent-gold);margin-bottom:.5rem}.hero .sub{font-size:1rem;opacity:.95;font-style:italic}.hero .meta{display:flex;justify-content:center;gap:1rem;flex-wrap:wrap;margin-top:.5rem;font-size:.9rem;color:var(--accent-gold);font-weight:600}.hero .meta b{color:var(--accent-gold)}body.dark .hero .meta,body.dark .hero .meta b{color:#B7791F}.table-container{background:#FFF;border-radius:1rem;overflow:hidden;box-shadow:0 4px 12px var(--shadow);border:1px solid var(--border);transition:background .3s ease,border .3s ease;will-change:background,border;overflow-x:auto}body.dark .table-container{background:var(--bg-white);border:1px solid var(--border)}table{width:100%;border-collapse:collapse;text-align:center;min-width:940px}thead{background:var(--primary);color:#FFF;transition:background .3s ease;will-change:background}th{padding:.9rem .75rem;font-weight:600;font-size:.875rem;position:sticky;top:0;z-index:10}td{padding:.75rem;border-top:1px solid var(--border);font-size:.875rem;transition:border .3s ease;will-change:border}.center{text-align:center}.muted{color:#5A6784}body.dark .muted{color:#A0AEC0}.strong{font-weight:700;color:#0F172A}body.dark .strong{color:#F7FAFC}tbody tr:nth-child(even){background:rgba(212,175,55,.05)}body.dark tbody tr:nth-child(even){background:rgba(183,121,31,.1)}tbody tr:hover{background:rgba(212,175,55,.1)}body.dark tbody tr:hover{background:rgba(183,121,31,.15)}.footer{text-align:center;margin-top:2rem;padding:1rem;font-size:.875rem;color:var(--text-dark);border-top:1px solid var(--border);transition:color .3s ease,border .3s ease;will-change:color,border}.footer a{color:var(--accent-gold);text-decoration:none;transition:color .3s ease}.footer a:hover{text-decoration:underline}.dark-toggle{position:fixed;top:1rem;right:1rem;z-index:1000;background:var(--primary);color:#FFF;border:none;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 2px 6px var(--shadow);transition:all .2s ease;min-height:44px;min-width:44px;touch-action:manipulation}.dark-toggle:hover{background:var(--accent-gold);color:var(--primary)}body.dark .dark-toggle{background:var(--accent-gold);color:var(--primary)}body.dark .dark-toggle:hover{background:var(--primary);color:var(--accent-gold)}.whatsapp-float{position:fixed;bottom:2rem;right:2rem;z-index:1000;background:linear-gradient(135deg,#25D366,#128C7E);color:#FFF;border-radius:16px;width:56px;height:56px;box-shadow:0 4px 15px rgba(37,211,102,.4);transition:all .3s ease;display:flex;align-items:center;justify-content:center;text-decoration:none;touch-action:manipulation}.whatsapp-float:hover{transform:translateY(-4px) scale(1.05);box-shadow:0 8px 20px rgba(37,211,102,.5)}.whatsapp-float i{font-size:1.9rem;filter:drop-shadow(0 1px 2px rgba(0,0,0,.2))}#back-to-top{position:fixed;bottom:7rem;right:2rem;z-index:1000;background:var(--primary);color:#FFF;border:none;border-radius:50%;width:40px;height:40px;display:none;align-items:center;justify-content:center;cursor:pointer;box-shadow:0 2px 6px var(--shadow);transition:all .2s ease;min-height:44px;min-width:44px;touch-action:manipulation}#back-to-top:hover{background:var(--accent-gold);color:var(--primary)}#back-to-top.show{display:flex}@media (max-width:768px){.hero h1{font-size:1.5rem}.hero .sub,.hero .meta{font-size:.85rem}.table-container{overflow-x:auto}th,td{padding:.5rem .6rem;font-size:.8rem}.footer{padding:.75rem;font-size:.8rem}.whatsapp-float{bottom:1rem;right:1rem;width:50px;height:50px}#back-to-top{bottom:5.5rem;right:1rem;width:35px;height:35px}.dark-toggle{top:.5rem;right:.5rem}} @media (max-width:480px){.container{padding:.5rem}}
</style>
</head>
<body>
<button class="dark-toggle" onclick="toggleDarkMode()"><i class="fas fa-moon"></i></button>
<div class="container">
<div class="back-nav"><a href="../index.html" class="back-btn"><i class="fas fa-arrow-left"></i><span>Back to Dashboard</span></a></div>
<section class="hero"><h1>RUBRIK PENILAIAN PTS</h1><div class="sub">Semester Ganjil 2025 / Kelas VIII & IX MTsT Daarut Tahfizh Al-Ikhlas</div><div class="meta"><div>Guru: <b>Ahmad Zaman Huri, S.Pd.</b></div></div></section>
<div class="table-container"><table id="tbl"><thead><tr id="thead"></tr></thead><tbody id="tbody"><tr><td colspan="7" class="center muted"><i class="fas fa-spinner fa-spin"></i> Memuat rubrik...</td></tr></tbody></table></div>
<footer class="footer"><div><i class="fas fa-book-open"></i> <b>RUBRIK PENILAIAN PTS</b> · Developed by <a href="https://wa.me/6282246077307" target="_blank">Ahmad Zaman Huri, S.Pd.</a></div></footer>
</div>
<a href="https://wa.me/6282246077307" class="whatsapp-float" target="_blank" title="Hubungi via WhatsApp"><i class="fab fa-whatsapp"></i></a>
<button id="back-to-top" onclick="scrollToTop()"><i class="fas fa-arrow-up"></i></button>
<script>
function toggleDarkMode(){document.body.classList.toggle('dark');const icon=document.querySelector('.dark-toggle i');icon.classList.toggle('fa-moon');icon.classList.toggle('fa-sun')}function scrollToTop(){window.scrollTo({top:0,behavior:'smooth'})}window.addEventListener('scroll',()=>{const btn=document.getElementById('back-to-top');if(window.scrollY>100){btn.classList.add('show')}else{btn.classList.remove('show')}});(async()=>{const CSV_URL="https://docs.google.com/spreadsheets/d/1yT7_KQLVylZEPqHKucrt1Zz7d2gHEiOx4pgmGKPALa0/gviz/tq?tqx=out:csv&sheet=Rubrik";const TARGET_COLUMNS=["Jenjang","Bagian / Chapter","Jenis Soal / Bentuk Tugas","Aspek yang Dinilai","Bobot","Kriteria Penilaian","Cara Menilai"];try{const normalize=t=>(t||"").replace(/\ufeff/g,"").replace(/[\u200B-\u200D]/g,"").replace(/[–—]/g,"-").replace(/\s*\/\s*/g," / ").replace(/\s+/g," ").trim().toLowerCase();const parseCSV=csv=>{const rows=[];let row=[],value="",inQuotes=false;for(let i=0;i<csv.length;i++){const char=csv[i],nextChar=csv[i+1];if(char==='"'){inQuotes=!inQuotes}else if(char===','&&!inQuotes){row.push(value);value=""}else if(char==='\n'&&!inQuotes){row.push(value);rows.push(row);row=[];value=""}else if(char==='\r'&&nextChar==='\n'&&!inQuotes){row.push(value);rows.push(row);row=[];value="";i++}else{value+=char}}if(value||row.length){row.push(value);rows.push(row)}return rows.map(r=>r.map(c=>(c||"").trim().replace(/^"(.+)"$/,"$1").replace(/""/g,'"')))};const headerSynonyms={"jenjang":["jenjang","kelas"],"bagian / chapter":["bagian / chapter","bagian/chapter","bagian - chapter","bagian- chapter","chapter","bagian"],"jenis soal / bentuk tugas":["jenis soal / bentuk tugas","jenis soal","bentuk tugas","jenis/bentuk"],"aspek yang dinilai":["aspek yang dinilai","aspek","komponen dinilai"],"bobot":["bobot","weight","skor bobot"],"kriteria penilaian":["kriteria penilaian","kriteria"],"cara menilai":["cara menilai","metode penilaian","perhitungan nilai"]};const findHeaderRowIndex=rows=>{let bestIndex=-1,bestScore=-1;for(let i=0;i<Math.min(rows.length,10);i++){const row=rows[i].map(normalize);let score=0;for(const target of TARGET_COLUMNS){const keys=headerSynonyms[target.toLowerCase()]||[target.toLowerCase()];if(keys.some(k=>row.includes(k)||row.some(c=>c.includes(k))))score++}if(score>bestScore){bestScore=score;bestIndex=i}}return bestScore>=4?bestIndex:0};const res=await fetch(CSV_URL);if(!res.ok)throw new Error('Gagal mengambil data');const csv=await res.text();const rows=parseCSV(csv);const headerRowIndex=findHeaderRowIndex(rows);const rawHeaders=rows[headerRowIndex]||[];const dataRows=rows.slice(headerRowIndex+1);const thead=document.getElementById("thead");TARGET_COLUMNS.forEach(c=>{const th=document.createElement("th");th.textContent=c;thead.appendChild(th)});const normalizedHeaders=rawHeaders.map(normalize);const getColumnIndex=(t,fb)=>{const keys=headerSynonyms[t.toLowerCase()]||[t.toLowerCase()];for(const k of keys){const i=normalizedHeaders.indexOf(k);if(i>=0)return i}for(const k of keys){const i=normalizedHeaders.findIndex(h=>h.includes(k));if(i>=0)return i}return fb};const columnIndices=TARGET_COLUMNS.map((c,i)=>getColumnIndex(c,i));const tbody=document.getElementById("tbody");tbody.innerHTML="";dataRows.forEach(row=>{if(!row.length||row.every(c=>String(c||"").trim()===""))return;const tr=document.createElement("tr");TARGET_COLUMNS.forEach((c,i)=>{const td=document.createElement("td");let v=row[columnIndices[i]]??"";v=String(v||"").trim()||"-";if(c==="Jenjang"||c==="Bobot")td.className="center";if(c==="Bagian / Chapter")td.classList.add("strong");if(c==="Cara Menilai")td.classList.add("muted");td.textContent=v;tr.appendChild(td)});tbody.appendChild(tr)});if(tbody.children.length===0)tbody.innerHTML='<tr><td colspan="7" class="center muted">Tidak ada data rubrik</td></tr>'}catch(error){document.getElementById("tbody").innerHTML='<tr><td colspan="7" class="center muted"><i class="fas fa-exclamation-circle"></i> Gagal memuat data rubrik</td></tr>'}})()
</script>
</body>
</html>